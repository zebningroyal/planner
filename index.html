<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Md Shazeb's Weekly Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #2dd4bf;
            --bg-dark: #0f172a;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: var(--bg-dark);
            background-image: 
                radial-gradient(at 0% 0%, rgba(56, 189, 248, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(45, 212, 191, 0.1) 0px, transparent 50%);
            min-height: 100vh;
            color: white;
            padding-bottom: 40px;
            overflow-x: hidden;
        }

        .glass {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
        }

        .task-done { text-decoration: line-through; opacity: 0.4; filter: grayscale(1); }

        .day-column { 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1px solid rgba(255, 255, 255, 0.03); 
        }
        
        .day-column:hover {
            transform: translateY(-6px);
            border-color: rgba(45, 212, 191, 0.3);
            background: rgba(30, 41, 59, 0.8);
        }

        @keyframes popIn {
            0% { transform: translate(-50%, -45%) scale(0.9); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        .pop-alert {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            z-index: 300;
        }

        .pulse-teal { animation: shadow-pulse 2s infinite; }
        @keyframes shadow-pulse {
            0% { box-shadow: 0 0 0 0px rgba(45, 212, 191, 0.4); }
            70% { box-shadow: 0 0 0 20px rgba(45, 212, 191, 0); }
            100% { box-shadow: 0 0 0 0px rgba(45, 212, 191, 0); }
        }

        .digital-clock { font-family: 'Courier New', Courier, monospace; letter-spacing: 2px; }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.1); border-radius: 10px; }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- TASK ALERT NOTIFICATION -->
    <div id="alert-overlay" class="fixed inset-0 bg-slate-950/90 backdrop-blur-xl z-[200] hidden items-center justify-center">
        <div class="glass pop-alert p-8 max-w-sm w-full border-2 border-teal-500/30 pulse-teal text-center">
            <div class="w-20 h-20 bg-teal-500 rounded-full flex items-center justify-center text-slate-900 mx-auto mb-6 shadow-xl shadow-teal-500/40 animate-bounce">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                </svg>
            </div>
            <h2 class="text-teal-400 font-black uppercase tracking-[0.2em] text-[10px] mb-2">Alarm Active</h2>
            <div id="alert-time-badge" class="inline-block bg-teal-500/10 text-teal-400 px-3 py-1 rounded-full text-xs font-bold mb-4">--:--</div>
            <h3 id="alert-task-text" class="text-2xl font-bold text-white leading-tight mb-8 italic">Task Title</h3>
            
            <div class="flex flex-col gap-3">
                <button onclick="dismissAlert()" class="w-full bg-teal-500 hover:bg-teal-400 text-slate-900 font-bold py-4 rounded-xl transition-all active:scale-95 shadow-lg shadow-teal-500/20 uppercase tracking-widest text-xs">
                    I'm Doing This Now
                </button>
                <button onclick="snoozeAlert()" class="w-full bg-slate-800 hover:bg-slate-700 text-white font-bold py-4 rounded-xl transition-all active:scale-95 border border-white/10 uppercase tracking-widest text-[10px]">
                    Snooze (5 Minutes)
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto">
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-10">
            <div>
                <h1 class="text-4xl font-extrabold text-white tracking-tight">Md Shazeb's <span class="text-teal-400">Planner</span></h1>
                <div class="flex items-center gap-3 mt-2">
                    <div id="status-indicator" class="w-2 h-2 rounded-full bg-rose-500"></div>
                    <span class="text-[11px] text-slate-400 font-bold uppercase tracking-[0.2em]">Live Clock: <span id="clock" class="digital-clock text-white">00:00:00</span></span>
                    <button onclick="requestAlarmAccess()" id="bg-btn" class="ml-2 text-[9px] bg-teal-500/10 text-teal-400 border border-teal-500/20 px-3 py-1.5 rounded-lg hover:bg-teal-500 hover:text-slate-900 transition-all font-black uppercase tracking-widest">Enable Sound</button>
                </div>
            </div>
            <div class="flex gap-4">
                <button onclick="resetWeek()" class="bg-rose-500/10 hover:bg-rose-500/20 text-rose-400 px-6 py-3 rounded-xl text-[10px] font-bold uppercase tracking-widest border border-rose-500/20">Clear All</button>
            </div>
        </header>

        <div class="glass p-8 mb-10">
            <div class="flex items-center gap-4 mb-5">
                <div class="w-12 h-12 bg-teal-500 rounded-xl flex items-center justify-center text-slate-900 shadow-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M12 4v16m8-8H4" /></svg>
                </div>
                <div>
                    <h2 class="font-extrabold text-sm text-white uppercase tracking-widest">Quick Task Entry</h2>
                    <p class="text-[11px] text-slate-400">Example: "Meeting at 2:30pm Monday"</p>
                </div>
            </div>
            <div class="relative">
                <input id="command-input" class="w-full bg-slate-900/50 border border-white/10 rounded-2xl px-6 py-5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-teal-500/50" placeholder="Type task here...">
                <button onclick="processCommand()" class="absolute top-1/2 -translate-y-1/2 right-4 bg-teal-500 hover:bg-teal-400 text-slate-900 font-black text-[10px] uppercase tracking-widest px-6 py-2.5 rounded-lg transition-all">Add Task</button>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-7 gap-6" id="planner-grid"></div>
    </div>

    <script>
        const days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
        let plannerData = JSON.parse(localStorage.getItem('prod_suite_v3')) || days.reduce((a, d) => ({...a, [d]: []}), {});
        let alarmInterval = null;
        let activeAlarmTask = null;
        let lastTriggeredMinute = "";

        // Alarm Logic
        function playAlarmSound() {
            try {
                const context = new (window.AudioContext || window.webkitAudioContext)();
                const osc = context.createOscillator();
                const gain = context.createGain();
                osc.type = 'square';
                osc.frequency.setValueAtTime(880, context.currentTime); // High pitch A5
                osc.connect(gain);
                gain.connect(context.destination);
                gain.gain.setValueAtTime(0, context.currentTime);
                gain.gain.linearRampToValueAtTime(0.3, context.currentTime + 0.05);
                gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.4);
                osc.start();
                osc.stop(context.currentTime + 0.5);
                if (navigator.vibrate) navigator.vibrate([300, 100, 300]);
            } catch(e) {}
        }

        function requestAlarmAccess() {
            // Trigger audio context unlock
            playAlarmSound();
            document.getElementById('status-indicator').classList.replace('bg-rose-500', 'bg-teal-500');
            document.getElementById('status-indicator').classList.add('animate-pulse');
            document.getElementById('bg-btn').innerText = "Sound Ready";
            document.getElementById('bg-btn').style.opacity = "0.5";
        }

        function startAlarm(task) {
            if (alarmInterval) return;
            activeAlarmTask = task;
            document.getElementById('alert-task-text').innerText = task.text;
            document.getElementById('alert-time-badge').innerText = task.timeLabel;
            document.getElementById('alert-overlay').classList.remove('hidden');
            document.getElementById('alert-overlay').classList.add('flex');
            
            playAlarmSound();
            alarmInterval = setInterval(playAlarmSound, 1000);
        }

        function dismissAlert() {
            clearInterval(alarmInterval);
            alarmInterval = null;
            document.getElementById('alert-overlay').classList.add('hidden');
            document.getElementById('alert-overlay').classList.remove('flex');
            
            // Mark task as done
            if (activeAlarmTask) {
                toggleTask(activeAlarmTask.day, activeAlarmTask.id);
            }
        }

        function snoozeAlert() {
            clearInterval(alarmInterval);
            alarmInterval = null;
            document.getElementById('alert-overlay').classList.add('hidden');
            document.getElementById('alert-overlay').classList.remove('flex');

            if (activeAlarmTask) {
                // Schedule a snooze reminder for 5 minutes from now
                const now = new Date();
                const snoozeTime = new Date(now.getTime() + 5 * 60000);
                const h = snoozeTime.getHours();
                const m = snoozeTime.getMinutes().toString().padStart(2, '0');
                const ampm = h >= 12 ? 'PM' : 'AM';
                const snoozeLabel = `${h % 12 || 12}:${m}${ampm}`;

                plannerData[activeAlarmTask.day].push({
                    text: `Snoozed: ${activeAlarmTask.text}`,
                    done: false,
                    timeLabel: snoozeLabel,
                    id: Date.now()
                });
                render();
            }
        }

        function updateClock() {
            const now = new Date();
            const h24 = now.getHours();
            const h12 = h24 % 12 || 12;
            const m = now.getMinutes().toString().padStart(2, '0');
            const s = now.getSeconds().toString().padStart(2, '0');
            const ampm = h24 >= 12 ? 'PM' : 'AM';
            const currentTimeStr = `${h12}:${m}${ampm}`;
            const currentDay = days[now.getDay()];

            document.getElementById('clock').innerText = `${h12}:${m}:${s} ${ampm}`;

            // Check for tasks
            if (lastTriggeredMinute !== currentTimeStr) {
                const dayTasks = plannerData[currentDay] || [];
                dayTasks.forEach(task => {
                    if (!task.done && task.timeLabel === currentTimeStr) {
                        task.day = currentDay; // Attach day for easier handling
                        startAlarm(task);
                        lastTriggeredMinute = currentTimeStr;
                    }
                });
            }
        }

        function processCommand() {
            const input = document.getElementById('command-input');
            const val = input.value.trim();
            if (!val) return;

            const timeMatch = val.match(/(\d{1,2}(:\d{2})?\s*(am|pm))/i);
            const timeLabel = timeMatch ? timeMatch[0].toUpperCase().replace(/\s/g, '') : "ANYTIME";
            
            let dayMatch = days.find(d => val.toLowerCase().includes(d.toLowerCase()));
            if(!dayMatch) dayMatch = days[new Date().getDay()];

            let taskName = val.replace(timeLabel, '').replace(new RegExp(dayMatch, 'gi'), '').replace(/at/gi, '').trim();
            
            plannerData[dayMatch].push({ 
                text: taskName || "Untitled Task", 
                done: false, 
                timeLabel: timeLabel, 
                id: Date.now() 
            });
            
            input.value = "";
            render();
        }

        function toggleTask(day, id) {
            const task = plannerData[day].find(t => t.id === id);
            if (task) task.done = !task.done;
            render();
        }

        function deleteTask(day, id) {
            plannerData[day] = plannerData[day].filter(t => t.id !== id);
            render();
        }

        function resetWeek() {
            if(confirm("Clear everything?")) {
                plannerData = days.reduce((a, d) => ({...a, [d]: []}), {});
                render();
            }
        }

        function render() {
            localStorage.setItem('prod_suite_v3', JSON.stringify(plannerData));
            const grid = document.getElementById('planner-grid');
            grid.innerHTML = '';

            days.forEach(day => {
                const dayTasks = plannerData[day];
                const col = document.createElement('div');
                col.className = 'day-column glass p-5 flex flex-col min-h-[300px]';
                col.innerHTML = `
                    <h3 class="font-black text-xs uppercase tracking-[0.2em] mb-4 text-teal-400 border-b border-teal-500/20 pb-2">${day}</h3>
                    <div class="flex-1 space-y-3">
                        ${dayTasks.map(t => `
                            <div class="group bg-slate-800/40 p-3 rounded-xl border border-white/5 hover:border-teal-500/30 transition-all ${t.done ? 'task-done' : ''}">
                                <div class="flex justify-between items-start mb-1">
                                    <span class="text-[9px] font-bold text-teal-500/80 uppercase">${t.timeLabel}</span>
                                    <button onclick="deleteTask('${day}', ${t.id})" class="opacity-0 group-hover:opacity-100 text-slate-500 hover:text-rose-500 transition-all">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                                    </button>
                                </div>
                                <p class="text-xs font-bold text-white leading-snug cursor-pointer" onclick="toggleTask('${day}', ${t.id})">${t.text}</p>
                            </div>
                        `).join('')}
                    </div>
                `;
                grid.appendChild(col);
            });
        }

        setInterval(updateClock, 1000);
        render();
    </script>
</body>
</html>
